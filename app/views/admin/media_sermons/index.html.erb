<%= render partial: 'shared/simple_page_header', locals: { 
  title: 'Media Library',
  btn_text: 'Upload Video',
  link: new_admin_media_sermon_path,
  icon: 'fa-photo-video' } %>

  <div class="container mt-n20">
    <div class="card ht pl-4 pr-4 pt-4 mb-5">
      <% if @admin_media_sermons.length > 0 %>
        <div class="text-right">
          <a href="<%= admin_media_sermons_path(view: 'table') %>" class="<%= params[:view] != 'grid' ? 'text-dark' : 'text-muted' %>  mr-2"><i class="fas fa-list-ul"></i></a>
          <a href="<%= admin_media_sermons_path(view: 'grid') %>" class="<%= params[:view] == 'grid' ? 'text-dark' : 'text-muted' %>"><i class="fas fa-th-large"></i></a>
        </div>
        <% if params[:view] == 'grid' %>
          <div class="video-library-grid-view">
            <% @admin_media_sermons.in_groups_of(3).each do |group| %>
              <div class="video-library-list mt-3">
                <div class="row">
                  <% group.each do |admin_media_sermon| %>
                    <% if admin_media_sermon.present? %>
                      <%= render 'sermon', sermon: admin_media_sermon, view: params[:view] %>
                    <% end %>
                  <% end %>
                </div>
              </div>
            <% end %>
          </div>
        <% else %>
        <div class="mt-3">
          <div class="tbl-header">
            <div class="table-responsive">
              <table class="table table-borderless mb-0">
                <thead>
                <tr>
                  <th class="text-black font-weight-500">Video Thumbnail</th>
                  <th class="text-black font-weight-500">Video Name</th>
                  <th class="text-black font-weight-500">Publish Status</th>
                  <th class="text-black font-weight-500"><%= sortable('created_at', 'Upload Date')  %> <%= sort_icon('created_at') %></th>
                  <th>&nbsp;</th>
                </tr>
                </thead>
              </table>
            </div>
          </div>
          <div class="video-library-list-view">
          <div class="tbl-content">
            <div class="table-responsive">
              <table class="table table-striped table-borderless mb-0">
                
                <tbody>
                <% @admin_media_sermons.each do |admin_media_sermon| %>
                  <%= render 'sermon', sermon: admin_media_sermon, view: params[:view] %>
                <% end %>
                </tbody>
              </table>
            </div>
          </div>
          </div>
          
        </div>
        <% end %>
      <% else %>
        <div class="alert alert-light" role="alert">
          You don't have any videos yet. Upload a video or start a live stream. 
        </div>
      <% end %>
    </div>
  </div>

<!-- Disables Hls Player
<script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
<script>
    document.addEventListener('turbolinks:load', function() {
        let videos = document.getElementsByClassName('video');
        length = videos.length
        for (let i = 0; i < length; i++) {
            let videoSrc = videos[i].src;
            if (Hls.isSupported() && videoSrc.indexOf('.m3u8') !== -1) {
                const hls = new Hls();
                hls.loadSource(videoSrc);
                hls.attachMedia(videos[i]);
            } else if (videos[i].canPlayType('application/vnd.apple.mpegurl')) {
                videos[i].src = videoSrc;
            }
        }
    });
</script>
-->

